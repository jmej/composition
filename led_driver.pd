#N canvas 495 190 803 425 10;
#X text 163 -127 time is in ms;
#X obj -28 -70 t a b;
#X obj -1 -45 s \$0-all_stop;
#X text 20 -139 type ms hue saturation;
#X obj -28 -117 inlet;
#X text 163 -140 h \, s \, v is given in range 0..1;
#X msg 34 -109 black 100 0.3 0.7 0.2;
#N canvas 371 1 1273 958 from_current 0;
#X msg 205 486 stop;
#X obj 205 464 r \$0-all_stop;
#X obj 227 513 r \$0-grain;
#X obj 98 419 f 1;
#X obj 393 89 t a b;
#X obj 393 132 unpack f f f f;
#X obj 182 403 pack f f;
#X msg 182 431 \$2 \$1;
#X msg 444 476 stop;
#X obj 444 454 r \$0-all_stop;
#X obj 466 506 r \$0-grain;
#X obj 337 409 f 1;
#X obj 421 393 pack f f;
#X msg 421 421 \$2 \$1;
#X obj 113 396 r \$0-cur_h;
#X obj 352 386 r \$0-cur_s;
#X msg 675 476 stop;
#X obj 675 454 r \$0-all_stop;
#X obj 697 506 r \$0-grain;
#X obj 568 409 f 1;
#X obj 652 393 pack f f;
#X msg 652 421 \$2 \$1;
#X obj 583 386 r \$0-cur_v;
#X obj 393 266 t f f f;
#X obj 393 46 inlet;
#X text 799 449 should value be log?;
#N canvas 483 254 647 776 remap_and_store 0;
#X obj 30 -18 inlet;
#X obj 32 584 outlet;
#X obj 69 413 * 127;
#X obj 69 436 i;
#X obj 69 463 mod 128;
#X obj 30 191 t a a;
#X msg 73 224 \$3 \$4 \$5;
#X text 78 191 address command h s v;
#X obj 73 251 unpack f f f;
#X obj 73 317 s \$0-cur_h;
#X obj 107 295 s \$0-cur_s;
#X obj 142 273 s \$0-cur_v;
#X obj 124 438 * 127;
#X obj 124 461 i;
#X obj 122 64 xnor_clamp 0 1;
#X obj 163 438 * 127;
#X obj 163 461 i;
#X obj 98 102 xnor_clamp 0 1;
#X obj 32 532 pack f f f f f;
#X obj 30 364 unpack f f f f f;
#X text 169 360 remap 0..1 to 0..127;
#X text 81 -17 store pre mapping but clamp first;
#X obj 30 150 pack f f f f f;
#X obj 30 32 unpack f f f f f;
#X connect 0 0 23 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 18 2;
#X connect 5 0 19 0;
#X connect 5 1 6 0;
#X connect 6 0 8 0;
#X connect 8 0 9 0;
#X connect 8 1 10 0;
#X connect 8 2 11 0;
#X connect 12 0 13 0;
#X connect 13 0 18 3;
#X connect 14 0 22 4;
#X connect 15 0 16 0;
#X connect 16 0 18 4;
#X connect 17 0 22 3;
#X connect 18 0 1 0;
#X connect 19 0 18 0;
#X connect 19 1 18 1;
#X connect 19 2 2 0;
#X connect 19 3 12 0;
#X connect 19 4 15 0;
#X connect 22 0 5 0;
#X connect 23 0 22 0;
#X connect 23 1 22 1;
#X connect 23 2 22 2;
#X connect 23 3 17 0;
#X connect 23 4 14 0;
#X restore 474 858 pd remap_and_store;
#X obj 609 697 + 128;
#X obj 609 673 r \$0-address;
#X msg 474 810 \$4 0 \$1 \$2 \$3;
#X obj 474 781 pack f f f 128;
#X obj 474 894 outlet;
#X obj 227 380 r \$0-target_h;
#X obj 466 370 r \$0-target_s;
#X obj 697 370 r \$0-target_v;
#X obj 474 156 s \$0-target_v;
#X obj 447 177 s \$0-target_s;
#X obj 420 201 s \$0-target_h;
#X obj 182 542 line 0 5;
#X obj 421 532 line 0 5;
#X obj 652 532 line 0 5;
#X connect 0 0 38 0;
#X connect 1 0 0 0;
#X connect 2 0 38 2;
#X connect 3 0 38 0;
#X connect 4 0 5 0;
#X connect 4 1 3 0;
#X connect 4 1 11 0;
#X connect 4 1 19 0;
#X connect 5 0 23 0;
#X connect 5 1 37 0;
#X connect 5 2 36 0;
#X connect 5 3 35 0;
#X connect 6 0 7 0;
#X connect 7 0 38 0;
#X connect 8 0 39 0;
#X connect 9 0 8 0;
#X connect 10 0 39 2;
#X connect 11 0 39 0;
#X connect 12 0 13 0;
#X connect 13 0 39 0;
#X connect 14 0 3 1;
#X connect 15 0 11 1;
#X connect 16 0 40 0;
#X connect 17 0 16 0;
#X connect 18 0 40 2;
#X connect 19 0 40 0;
#X connect 20 0 21 0;
#X connect 21 0 40 0;
#X connect 22 0 19 1;
#X connect 23 0 6 0;
#X connect 23 1 12 0;
#X connect 23 2 20 0;
#X connect 24 0 4 0;
#X connect 26 0 31 0;
#X connect 27 0 30 3;
#X connect 28 0 27 0;
#X connect 29 0 26 0;
#X connect 30 0 29 0;
#X connect 32 0 6 1;
#X connect 33 0 12 1;
#X connect 34 0 20 1;
#X connect 38 0 30 0;
#X connect 39 0 30 1;
#X connect 40 0 30 2;
#X restore 18 72 pd from_current;
#X obj 18 96 s \$0-command_out;
#X obj -60 204 r \$0-command_out;
#X obj -62 234 outlet;
#X obj 485 24 r \$0-cur_h;
#X floatatom 490 68 5 0 0 0 - - -;
#X floatatom 559 67 5 0 0 0 - - -;
#X floatatom 626 67 5 0 0 0 - - -;
#X obj 554 23 r \$0-cur_s;
#X obj 621 23 r \$0-cur_v;
#X msg 176 -108 current 100 0 0.7 0.295;
#X obj 56 51 s \$0-address;
#X obj 422 -102 loadbang;
#X obj 422 -69 i \$1;
#X obj 422 -40 s \$0-address;
#X text 422 -131 set the address;
#X obj 94 30 s \$0-grain;
#X text 190 -59 out ms;
#X text 192 -44 asr -> a(ms) s(ms) r(ms) h s v;
#X obj -101 -51 r \$0-fbdk;
#N canvas 239 147 975 663 out 0;
#X obj 28 228 expr log(1 + $f1 * (exp(1) - 1));
#X obj 82 298 + 128;
#X obj 82 274 r \$0-address;
#X msg 52 160 stop;
#X obj 52 138 r \$0-all_stop;
#X obj 90 165 r \$0-grain;
#N canvas 474 185 647 776 remap_and_store 0;
#X obj 30 -18 inlet;
#X obj 32 584 outlet;
#X obj 69 413 * 127;
#X obj 69 436 i;
#X obj 69 463 mod 128;
#X obj 30 191 t a a;
#X msg 73 224 \$3 \$4 \$5;
#X text 78 191 address command h s v;
#X obj 73 251 unpack f f f;
#X obj 73 317 s \$0-cur_h;
#X obj 107 295 s \$0-cur_s;
#X obj 142 273 s \$0-cur_v;
#X obj 124 438 * 127;
#X obj 124 461 i;
#X obj 122 64 xnor_clamp 0 1;
#X obj 163 438 * 127;
#X obj 163 461 i;
#X obj 98 102 xnor_clamp 0 1;
#X obj 32 532 pack f f f f f;
#X obj 30 364 unpack f f f f f;
#X text 169 360 remap 0..1 to 0..127;
#X text 81 -17 store pre mapping but clamp first;
#X obj 30 150 pack f f f f f;
#X obj 30 32 unpack f f f f f;
#X connect 0 0 23 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 18 2;
#X connect 5 0 19 0;
#X connect 5 1 6 0;
#X connect 6 0 8 0;
#X connect 8 0 9 0;
#X connect 8 1 10 0;
#X connect 8 2 11 0;
#X connect 12 0 13 0;
#X connect 13 0 18 3;
#X connect 14 0 22 4;
#X connect 15 0 16 0;
#X connect 16 0 18 4;
#X connect 17 0 22 3;
#X connect 18 0 1 0;
#X connect 19 0 18 0;
#X connect 19 1 18 1;
#X connect 19 2 2 0;
#X connect 19 3 12 0;
#X connect 19 4 15 0;
#X connect 22 0 5 0;
#X connect 23 0 22 0;
#X connect 23 1 22 1;
#X connect 23 2 22 2;
#X connect 23 3 17 0;
#X connect 23 4 14 0;
#X restore 28 431 pd remap_and_store;
#X msg 28 383 \$3 0 \$2 \$4 \$1;
#X obj 28 87 pack f f;
#X obj 28 463 s \$0-command_out;
#X obj 28 195 line 0 5;
#X obj 73 41 r \$0-cur_v;
#X obj 73 64 expr (exp($f1) - 1) / (exp(1) - 1);
#X obj 55 249 r \$0-cur_h;
#X obj 109 325 r \$0-cur_s;
#X obj 28 354 pack f 0 128 1;
#X msg 28 114 \$2 \, 0 \$1;
#X obj 22 15 inlet;
#X connect 0 0 15 0;
#X connect 1 0 15 2;
#X connect 2 0 1 0;
#X connect 3 0 10 0;
#X connect 4 0 3 0;
#X connect 5 0 10 2;
#X connect 6 0 9 0;
#X connect 7 0 6 0;
#X connect 8 0 16 0;
#X connect 10 0 0 0;
#X connect 11 0 12 0;
#X connect 12 0 8 1;
#X connect 13 0 15 1;
#X connect 14 0 15 3;
#X connect 15 0 7 0;
#X connect 16 0 10 0;
#X connect 17 0 8 0;
#X restore 132 91 pd out;
#N canvas 417 249 461 709 black 0;
#X obj -28 327 expr log(1 + $f1 * (exp(1) - 1));
#X obj 26 397 + 128;
#X obj 26 373 r \$0-address;
#X msg -4 259 stop;
#X obj -4 237 r \$0-all_stop;
#X obj 34 264 r \$0-grain;
#X obj -28 453 pack f 0 128 1;
#N canvas 471 162 647 776 remap_and_store 0;
#X obj 30 -18 inlet;
#X obj 32 584 outlet;
#X obj 69 413 * 127;
#X obj 69 436 i;
#X obj 69 463 mod 128;
#X obj 30 191 t a a;
#X msg 73 224 \$3 \$4 \$5;
#X text 78 191 address command h s v;
#X obj 73 251 unpack f f f;
#X obj 73 317 s \$0-cur_h;
#X obj 107 295 s \$0-cur_s;
#X obj 142 273 s \$0-cur_v;
#X obj 124 438 * 127;
#X obj 124 461 i;
#X obj 122 64 xnor_clamp 0 1;
#X obj 163 438 * 127;
#X obj 163 461 i;
#X obj 98 102 xnor_clamp 0 1;
#X obj 32 532 pack f f f f f;
#X obj 30 364 unpack f f f f f;
#X text 169 360 remap 0..1 to 0..127;
#X text 81 -17 store pre mapping but clamp first;
#X obj 30 150 pack f f f f f;
#X obj 30 32 unpack f f f f f;
#X connect 0 0 23 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 18 2;
#X connect 5 0 19 0;
#X connect 5 1 6 0;
#X connect 6 0 8 0;
#X connect 8 0 9 0;
#X connect 8 1 10 0;
#X connect 8 2 11 0;
#X connect 12 0 13 0;
#X connect 13 0 18 3;
#X connect 14 0 22 4;
#X connect 15 0 16 0;
#X connect 16 0 18 4;
#X connect 17 0 22 3;
#X connect 18 0 1 0;
#X connect 19 0 18 0;
#X connect 19 1 18 1;
#X connect 19 2 2 0;
#X connect 19 3 12 0;
#X connect 19 4 15 0;
#X connect 22 0 5 0;
#X connect 23 0 22 0;
#X connect 23 1 22 1;
#X connect 23 2 22 2;
#X connect 23 3 17 0;
#X connect 23 4 14 0;
#X restore -28 530 pd remap_and_store;
#X msg -28 482 \$3 0 \$2 \$4 \$1;
#X obj -28 97 unpack f f f f;
#X obj -28 186 pack f f;
#X msg -28 213 0 \, \$2 \$1;
#X obj -28 562 s \$0-command_out;
#X obj -1 157 s \$0-target_h;
#X obj 26 136 s \$0-target_s;
#X obj 53 424 r \$0-target_s;
#X obj -1 348 r \$0-target_h;
#X obj -28 294 line 0 5;
#X obj -12 43 inlet;
#X connect 0 0 6 0;
#X connect 1 0 6 2;
#X connect 2 0 1 0;
#X connect 3 0 17 0;
#X connect 4 0 3 0;
#X connect 5 0 17 2;
#X connect 6 0 8 0;
#X connect 7 0 12 0;
#X connect 8 0 7 0;
#X connect 9 0 10 0;
#X connect 9 1 13 0;
#X connect 9 2 14 0;
#X connect 9 3 10 1;
#X connect 10 0 11 0;
#X connect 11 0 17 0;
#X connect 15 0 6 3;
#X connect 16 0 6 1;
#X connect 17 0 0 0;
#X connect 18 0 9 0;
#X restore -20 119 pd black;
#N canvas 88 155 450 300 asr 0;
#X obj 38 42 t a a;
#X msg 90 80 black \$1 \$4 \$5 \$6;
#X obj 90 105 s \$0-fbdk;
#X obj 41 137 unpack f f;
#X obj 41 172 pipe;
#X msg 33 101 \$3 \$2;
#X msg 41 195 out \$1;
#X obj 41 222 s \$0-fbdk;
#X obj 38 20 inlet;
#X connect 0 0 5 0;
#X connect 0 1 1 0;
#X connect 1 0 2 0;
#X connect 3 0 4 0;
#X connect 3 1 4 1;
#X connect 4 0 6 0;
#X connect 5 0 3 0;
#X connect 6 0 7 0;
#X connect 8 0 0 0;
#X restore 170 68 pd asr;
#N canvas 105 150 450 300 set 0;
#X obj 125 73 + 128;
#X obj 125 49 r \$0-address;
#N canvas 474 185 647 776 remap_and_store 0;
#X obj 30 -18 inlet;
#X obj 32 584 outlet;
#X obj 69 413 * 127;
#X obj 69 436 i;
#X obj 69 463 mod 128;
#X obj 30 191 t a a;
#X msg 73 224 \$3 \$4 \$5;
#X text 78 191 address command h s v;
#X obj 73 251 unpack f f f;
#X obj 73 317 s \$0-cur_h;
#X obj 107 295 s \$0-cur_s;
#X obj 142 273 s \$0-cur_v;
#X obj 124 438 * 127;
#X obj 124 461 i;
#X obj 122 64 xnor_clamp 0 1;
#X obj 163 438 * 127;
#X obj 163 461 i;
#X obj 98 102 xnor_clamp 0 1;
#X obj 32 532 pack f f f f f;
#X obj 30 364 unpack f f f f f;
#X text 169 360 remap 0..1 to 0..127;
#X text 81 -17 store pre mapping but clamp first;
#X obj 30 150 pack f f f f f;
#X obj 30 32 unpack f f f f f;
#X connect 0 0 23 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 18 2;
#X connect 5 0 19 0;
#X connect 5 1 6 0;
#X connect 6 0 8 0;
#X connect 8 0 9 0;
#X connect 8 1 10 0;
#X connect 8 2 11 0;
#X connect 12 0 13 0;
#X connect 13 0 18 3;
#X connect 14 0 22 4;
#X connect 15 0 16 0;
#X connect 16 0 18 4;
#X connect 17 0 22 3;
#X connect 18 0 1 0;
#X connect 19 0 18 0;
#X connect 19 1 18 1;
#X connect 19 2 2 0;
#X connect 19 3 12 0;
#X connect 19 4 15 0;
#X connect 22 0 5 0;
#X connect 23 0 22 0;
#X connect 23 1 22 1;
#X connect 23 2 22 2;
#X connect 23 3 17 0;
#X connect 23 4 14 0;
#X restore 44 204 pd remap_and_store;
#X obj 44 236 s \$0-command_out;
#X obj 44 95 unpack f f f;
#X obj 44 127 pack f 0 f 128;
#X msg 44 156 \$4 0 \$1 \$2 \$3;
#X obj 44 15 inlet;
#X connect 0 0 5 3;
#X connect 1 0 0 0;
#X connect 2 0 3 0;
#X connect 4 0 5 0;
#X connect 4 1 5 1;
#X connect 4 2 5 2;
#X connect 5 0 6 0;
#X connect 6 0 2 0;
#X connect 7 0 4 0;
#X restore 208 47 pd set;
#X obj -20 -9 route black current address grain out asr set duck;
#N canvas 895 470 218 382 duck 0;
#X obj 38 42 t a a;
#X obj 132 105 s \$0-fbdk;
#X obj 33 238 pipe;
#X obj 33 326 s \$0-fbdk;
#X obj 38 20 inlet;
#X msg 132 81 out \$1;
#X msg 33 101 \$3 \$2 \$4 \$5 \$6;
#X obj 33 137 unpack f f f f f;
#X obj 33 271 pack f f f f;
#X msg 33 299 black \$1 \$2 \$3 \$4;
#X obj 33 167 t a b;
#X msg 44 202 clear;
#X connect 0 0 6 0;
#X connect 0 1 5 0;
#X connect 2 0 8 0;
#X connect 4 0 0 0;
#X connect 5 0 1 0;
#X connect 6 0 7 0;
#X connect 7 0 10 0;
#X connect 7 1 2 1;
#X connect 7 2 8 1;
#X connect 7 3 8 2;
#X connect 7 4 8 3;
#X connect 8 0 9 0;
#X connect 9 0 3 0;
#X connect 10 0 2 0;
#X connect 10 1 11 0;
#X connect 11 0 2 0;
#X restore 241 29 pd duck;
#X text 191 -32 duck -> a(ms) s(ms) r(ms) h s v;
#X connect 1 0 31 0;
#X connect 1 1 2 0;
#X connect 4 0 1 0;
#X connect 6 0 1 0;
#X connect 7 0 8 0;
#X connect 9 0 10 0;
#X connect 11 0 12 0;
#X connect 15 0 13 0;
#X connect 16 0 14 0;
#X connect 17 0 1 0;
#X connect 19 0 20 0;
#X connect 20 0 21 0;
#X connect 26 0 31 0;
#X connect 31 0 28 0;
#X connect 31 1 7 0;
#X connect 31 2 18 0;
#X connect 31 3 23 0;
#X connect 31 4 27 0;
#X connect 31 5 29 0;
#X connect 31 6 30 0;
#X connect 31 7 32 0;
